{"version":3,"sources":["webpack:///./Model.js","webpack:///./components/Modal.js","webpack:///./components/Header.js","webpack:///./components/Layout.js","webpack:///./components/Footer.js","webpack:///./components/Body.js","webpack:///./App.js","webpack:///./utils/helpers.js","webpack:///./index.js"],"names":["routes","urls","reduce","req","route","page","path","split","url","model","getData","state","showComment","comment","getPath","data","reqs","http","getDataById","id","prev","m","request","method","then","key","profile","tabsShowing","title","showModal","showUser","user","toggleComments","level","toggleModal","toggleUser","Header","view","attrs","close","onclick","Content","children","Footer","Modal","oninit","init","contents","footer","Tab","tab","isActive","Link","class","href","tabs","Object","keys","navTabs","without","mithrilIcon","map","idx","ModalStuff","Layout","Body","d","style","fill","rel","target","Component","showItem","onscroll","e","length","setpoint","scrollPos","scrollTop","limit","infiniteScroll","isEmpty","IsLoading","isPost","_post","Post","post","comments","isComment","set","c","Comment","created","about","karma","userModalInfo","toRoute","onmatch","_","render","comments_count","domain","points","time_ago","toComment","content","showComments","console","log","trust","toUnFurl","root","document","body","getProfile","w","winW","window","innerWidth","navigator","addEventListener","serviceWorker","register","registration","registrationError","checkWidth","lastProfile","redraw","requestAnimationFrame","makeRoutes"],"mappings":"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","file":"main-chunk.js","sourcesContent":["const routes = [\r\n  'news',\r\n  'newest',\r\n  'ask',\r\n  'show',\r\n  'jobs',\r\n  'item/:key',\r\n  'user/:key',\r\n]\r\n\r\nconst url = (route) => (page) => {\r\n  let path = route.split('/')[0]\r\n  return `https://api.hnpwa.com/v0/${path}/${page}.json`\r\n}\r\n\r\nconst urls = routes.reduce((req, route) => {\r\n  req[route] = url(route)\r\n  return req\r\n}, {})\r\n\r\nconst http = (model) => (url) => (route) =>\r\n  m\r\n    .request({\r\n      url,\r\n      method: 'GET',\r\n    })\r\n    .then((data) => {\r\n      model.data[route].data = data\r\n      return model\r\n    })\r\n\r\nconst reqs = {\r\n  urls,\r\n  http,\r\n}\r\n\r\nconst getData = (model) => (route) => {\r\n  model.state.showComment = false\r\n  model.state.comment = {}\r\n  model.state.route = route\r\n  let path = model.getPath(route)\r\n  model.data[route] ? model.data[route] : (model.data[route] = { data: [] })\r\n  model.reqs.http(model)(model.reqs.urls[path](model.state.page))(route)\r\n}\r\n\r\nconst getDataById = (model) => (route) => (id) => {\r\n  model.state.prev = model.state.route\r\n\r\n  if (route == 'item') {\r\n    model.state.route = route\r\n  }\r\n\r\n  model.data[route] ? model.data[route] : (model.data[route] = { data: [] })\r\n  model.reqs.http(model)(model.reqs.urls[`${route}/:key`](id))(route)\r\n}\r\n\r\nconst getPath = (route) => route.split('/')[1]\r\n\r\nconst state = {\r\n  key: '',\r\n  url: '',\r\n  route: '',\r\n  page: 1,\r\n  profile: '',\r\n  tabsShowing: false,\r\n  title: '',\r\n  comment: {},\r\n  showModal: false,\r\n  showUser: false,\r\n  user: { id: '' },\r\n}\r\n\r\nconst toggleComments = ({ model, key, level }) =>\r\n  model.state.comment[`${key}-${level}`]\r\n    ? (model.state.comment[`${key}-${level}`] = !model.state.comment[\r\n      `${key}-${level}`\r\n    ])\r\n    : (model.state.comment[`${key}-${level}`] = true)\r\n\r\nconst toggleModal = (model) => (model.state.showModal = !model.state.showModal)\r\n\r\nconst toggleUser = (model) => (id) => {\r\n  model.state.user.id = id\r\n  model.state.showUser = !model.state.showUser\r\n}\r\n\r\nexport const model = {\r\n  getData,\r\n  getDataById,\r\n  routes,\r\n  getPath,\r\n  reqs,\r\n  data: {},\r\n  state,\r\n  toggleComments,\r\n  toggleModal,\r\n  toggleUser,\r\n}\r\n","import m from 'mithril'\r\n\r\nconst Header = {\r\n  view: ({ attrs: { title, model, close } }) => {\r\n    return m('.modal-header', [\r\n      m('h4.title', title),\r\n      m(\r\n        'button.closeBtn',\r\n        {\r\n          onclick: () => close(model),\r\n        },\r\n        'X'\r\n      ),\r\n    ])\r\n  },\r\n}\r\n\r\nconst Content = {\r\n  view: ({ children }) => m('.modal-contents', children),\r\n}\r\n\r\nconst Footer = {\r\n  view: ({ children }) => m('.modal-footer', children),\r\n}\r\n\r\nconst Modal = {\r\n  oninit: ({ attrs: { init, model } }) => init(model),\r\n  view: ({ attrs: { title, contents, footer, model, close } }) =>\r\n    m(\r\n      'section.modalContainer',\r\n      m('.modal', {}, [\r\n        m(Header, { title, model, close }),\r\n        m(Content, contents),\r\n        m(Footer, footer),\r\n      ])\r\n    ),\r\n}\r\n\r\nexport default Modal\r\n","import m from 'mithril'\r\nimport { without } from 'ramda'\r\nimport Modal from './Modal.js'\r\n\r\nconst mithrilIcon = m('path', {\r\n  d:\r\n    'M31.716,13.5C31.699,6.47,25.974,0.755,18.94,0.755c-7.045,0-12.777,5.732-12.777,12.777\\n\\t\\t\\tc0,0.022,0.004,0.043,0.004,0.065C2.477,15.84,0,19.887,0,24.511c0,7.046,5.731,12.777,12.777,12.777\\n\\t\\t\\tc2.268,0,4.395-0.601,6.244-1.642c1.849,1.041,3.977,1.642,6.245,1.642c7.046,0,12.777-5.732,12.777-12.777\\n\\t\\t\\tC38.043,19.82,35.495,15.722,31.716,13.5z M19.021,32.961c-2.312-1.713-3.906-4.341-4.22-7.352c1.3,0.448,2.689,0.702,4.139,0.702\\n\\t\\t\\tc1.514,0,2.96-0.278,4.307-0.764C22.949,28.584,21.349,31.236,19.021,32.961z M8.517,14.898c1.303-0.579,2.743-0.909,4.26-0.909\\n\\t\\t\\tc1.475,0,2.879,0.307,4.154,0.858c-2.114,1.826-3.629,4.325-4.195,7.167C10.473,20.352,8.898,17.814,8.517,14.898z M18.94,24.055\\n\\t\\t\\tc-1.457,0-2.846-0.298-4.109-0.837c0.361-2.928,1.929-5.482,4.19-7.157c2.243,1.662,3.802,4.187,4.18,7.085\\n\\t\\t\\tC21.897,23.727,20.457,24.055,18.94,24.055z M21.111,14.846c1.275-0.55,2.679-0.858,4.154-0.858c1.457,0,2.846,0.298,4.11,0.837\\n\\t\\t\\tc-0.356,2.885-1.883,5.404-4.089,7.082C24.704,19.108,23.199,16.65,21.111,14.846z M18.94,3.01c5.432,0,9.915,4.137,10.466,9.425\\n\\t\\t\\tc-1.3-0.447-2.689-0.702-4.14-0.702c-2.268,0-4.396,0.601-6.245,1.642c-1.848-1.041-3.975-1.642-6.244-1.642\\n\\t\\t\\tc-1.514,0-2.96,0.278-4.307,0.763C8.993,7.179,13.488,3.01,18.94,3.01z M12.777,35.034c-5.803,0-10.523-4.72-10.523-10.523\\n\\t\\t\\tc0-3.418,1.645-6.451,4.177-8.375c0.744,3.581,2.999,6.607,6.059,8.408c0.011,3.847,1.735,7.293,4.442,9.631\\n\\t\\t\\tC15.656,34.727,14.253,35.034,12.777,35.034z M25.266,35.034c-1.475,0-2.879-0.307-4.154-0.858\\n\\t\\t\\tc2.715-2.345,4.444-5.804,4.444-9.664c0-0.022-0.004-0.044-0.004-0.065c3.007-1.829,5.209-4.852,5.918-8.416\\n\\t\\t\\tc2.613,1.917,4.319,4.999,4.319,8.48C35.788,30.313,31.068,35.034,25.266,35.034z',\r\n  style: { fill: 'white' },\r\n})\r\n\r\nconst ModalStuff = {\r\n  init: () => {},\r\n  close: (model) => model.toggleModal(model),\r\n  title: 'About',\r\n  contents: [\r\n    m(\r\n      'p',\r\n      'built with ',\r\n      m(\r\n        'a',\r\n        { rel: 'noopener', target: '_blank', href: 'https://mithril.js.org' },\r\n        ' Mithril.JS'\r\n      ),\r\n      ' and webpack'\r\n    ),\r\n    m(\r\n      'p',\r\n      'source code: ',\r\n      m(\r\n        'a',\r\n        {\r\n          rel: 'noopener',\r\n          target: '_blank',\r\n          href: 'https://github.com/boazblake/mithril-hn-pwa',\r\n        },\r\n        'can be found here'\r\n      )\r\n    ),\r\n  ],\r\n  footer: [\r\n    m('p', [\r\n      'made by ',\r\n      m(\r\n        'a',\r\n        {\r\n          rel: 'noopener',\r\n          target: '_blank',\r\n          href: 'https://linkedin.com/in/boazblake/',\r\n        },\r\n        'B Blake'\r\n      ),\r\n    ]),\r\n  ],\r\n}\r\n\r\nconst Tab = ({ attrs: { key } }) => {\r\n  return {\r\n    view: ({ attrs: { tab, isActive } }) =>\r\n      m(\r\n        m.route.Link,\r\n        {\r\n          class: `tab${isActive ? ' underline' : ''}`,\r\n          key,\r\n          id: `${tab}`,\r\n          href: `/${tab}`,\r\n        },\r\n        tab\r\n      ),\r\n  }\r\n}\r\n\r\nconst Header = ({ attrs: { model } }) => {\r\n  let tabs = Object.keys(model.reqs.urls)\r\n  let navTabs = without(['item/:key', 'user/:key'], tabs)\r\n  return {\r\n    view: ({ attrs: { model } }) =>\r\n      m(\r\n        '.header',\r\n        {\r\n          id: 'header',\r\n        },\r\n        [\r\n          m(\r\n            'svg.brand',\r\n            { onclick: () => model.toggleModal(model) },\r\n            mithrilIcon\r\n          ),\r\n          navTabs.map((tab, idx) =>\r\n            m(Tab, {\r\n              key: idx,\r\n              isActive: model.state.route == `/${tab}`,\r\n              tab,\r\n            })\r\n          ),\r\n          model.state.showModal ? m(Modal, { ...ModalStuff, model }) : '',\r\n        ]\r\n      ),\r\n  }\r\n}\r\n\r\nexport default Header\r\n","import m from 'mithril'\r\nimport Header from './Header.js'\r\nimport Footer from './Footer.js'\r\nimport Body from './Body.js'\r\n\r\nconst Layout = ({ attrs: { model } }) => {\r\n  return {\r\n    view: ({ children }) =>\r\n      m(\r\n        'section.layout',\r\n        {\r\n          id: 'layout',\r\n        },\r\n        children\r\n          ? [\r\n            m(Header, { model }),\r\n            m(Body, { model, children }),\r\n            m(Footer, { model }),\r\n          ]\r\n          : []\r\n      ),\r\n  }\r\n}\r\n\r\nexport default Layout\r\n","import m from 'mithril'\r\n\r\nconst Footer = {\r\n  view: () =>\r\n    m(\r\n      'footer.footer',\r\n      {\r\n        id: 'footer',\r\n      },\r\n      'content served from https://api.hnpwa.com/'\r\n    ),\r\n}\r\n\r\nexport default Footer\r\n","import m from 'mithril'\r\n\r\nconst Body = {\r\n  view: ({ attrs: { children } }) =>\r\n    m('section.content', { id: 'content' }, children),\r\n}\r\n\r\nexport default Body\r\n","import m from 'mithril'\r\nimport Layout from './components/Layout.js'\r\nimport Modal from './components/Modal.js'\r\nimport { isEmpty, init, infiniteScroll } from './utils/index'\r\n\r\nconst IsLoading = m('.holder', [\r\n  m('.preloader', [\r\n    m('div'),\r\n    m('div'),\r\n    m('div'),\r\n    m('div'),\r\n    m('div'),\r\n    m('div'),\r\n    m('div'),\r\n  ]),\r\n])\r\n\r\nconst plus =\r\n  'M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-5v5h-2v-5h-5v-2h5v-5h2v5h5v2z'\r\nconst minus =\r\n  'M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-12v-2h12v2z'\r\n\r\nconst toUnFurl = (bool = false) =>\r\n  bool ? m('path.highlight', { d: minus }) : m('path.highlight', { d: plus })\r\n\r\nconst userModalInfo = (model) => ({\r\n  init: (model) => model.getDataById(model)('user')(model.state.user.id),\r\n  close: (model) => model.toggleUser(model)(''),\r\n  title: 'User',\r\n  contents:\r\n    model.data.user && model.data.user.data\r\n      ? [\r\n        m('code', `id: ${model.data.user.data.id}`),\r\n        m('code', `created: ${model.data.user.data.created}`),\r\n        m('code', `about: ${model.data.user.data.about}`),\r\n        m('code', `karma: ${model.data.user.data.karma}`),\r\n      ]\r\n      : [],\r\n  footer: [],\r\n})\r\n\r\nconst toComment = (comments_count) => (showItem) => (id, title) =>\r\n  comments_count\r\n    ? m(\r\n      m.route.Link,\r\n      {\r\n        class: 'bottom',\r\n        href: `/item/${id}`,\r\n        onclick: () => showItem(id, title),\r\n      },\r\n      `${comments_count} comments`\r\n    )\r\n    : `${comments_count} comments`\r\n\r\nconst Post = {\r\n  view: ({\r\n    attrs: {\r\n      model,\r\n      showItem,\r\n      post: { comments_count, domain, id, points, time_ago, title, url, user },\r\n    },\r\n  }) => {\r\n    return m(\r\n      '.postContainer',\r\n      {\r\n        id: `${id}`,\r\n      },\r\n      [\r\n        m('.top', [\r\n          m('h1.title', title),\r\n          m(\r\n            'code.subTitle',\r\n            ' from ',\r\n            m(\r\n              'a.',\r\n              { target: '_blank', href: url, rel: 'noopener' },\r\n              `${domain}`\r\n            )\r\n          ),\r\n        ]),\r\n        m('.bottom', [\r\n          m('.left', [\r\n            m(\r\n              '.top.highlight.cursor',\r\n              {\r\n                onclick: () => {\r\n                  model.toggleUser(model)(user)\r\n                },\r\n              },\r\n              ` by ${user}`\r\n            ),\r\n            m('code.bottom', `${time_ago}`),\r\n          ]),\r\n          m('.right', [\r\n            m('code.highlight.top', `${points} points`),\r\n            toComment(comments_count)(showItem)(id, title),\r\n          ]),\r\n        ]),\r\n      ]\r\n    )\r\n  },\r\n}\r\n\r\nconst Comment = {\r\n  view: ({\r\n    attrs: {\r\n      key,\r\n      model,\r\n      comment: { comments, comments_count, id, time_ago, content, level, user },\r\n    },\r\n  }) => {\r\n    let state = {\r\n      showComments: model.state.comment[`${key}-${level}`] || false,\r\n    }\r\n\r\n    return m(\r\n      '.commentContainer',\r\n      {\r\n        id: `${id}`,\r\n      },\r\n      [\r\n        m('.', [\r\n          m(\r\n            'a.highlight.cursor',\r\n            {\r\n              onclick: () => {\r\n                model.toggleUser(model)(user)\r\n                console.log(user)\r\n              },\r\n            },\r\n            ` ${user}`\r\n          ),\r\n          m('code', ` ${time_ago}`),\r\n        ]),\r\n        m('.nudgeRight', [\r\n          m('code', m.trust(content)),\r\n          comments_count\r\n            ? m(\r\n              'button.commentBtn',\r\n              { onclick: () => model.toggleComments({ model, key, level }) },\r\n              [\r\n                m('svg.toggleCommentSvg', toUnFurl(state.showComments)),\r\n                `${comments_count} comments`,\r\n              ]\r\n            )\r\n            : '',\r\n          state.showComments\r\n            ? comments.map((c, idx) =>\r\n              m(Comment, {\r\n                key: idx,\r\n                comment: c,\r\n                model,\r\n              })\r\n            )\r\n            : '',\r\n        ]),\r\n      ]\r\n    )\r\n  },\r\n}\r\n\r\nconst Component = () => {\r\n  const isPost = (data) => data.map\r\n  const isComment = (data) => data.comments && data.comments.map\r\n\r\n  return {\r\n    view: ({ attrs: { model } }) => {\r\n      let route = model.state.route\r\n      let data = model.data[route].data\r\n\r\n      let showItem = (id, title = '') => {\r\n        model.state.title = title\r\n        model.state.id = id\r\n        model.state.showComment = !model.state.showComment\r\n      }\r\n      return m(\r\n        'section.component',\r\n        {\r\n          id: 'component',\r\n          route: model.state.route,\r\n          onscroll: infiniteScroll(model),\r\n        },\r\n        [\r\n          isEmpty(data)\r\n            ? m('.loader', IsLoading)\r\n            : isPost(data)\r\n              ? data.map((_post, idx) =>\r\n                m(Post, {\r\n                  key: idx,\r\n                  post: _post,\r\n                  model,\r\n                  showItem,\r\n                })\r\n              )\r\n              : isComment(data)\r\n                ? [\r\n                  m('.titleContainer', [\r\n                    m(\r\n                      'button.backBtn',\r\n                      {\r\n                        onclick: () => m.route.set(model.state.prev || '/news'),\r\n                      },\r\n                      'Back'\r\n                    ),\r\n                    m('h1.title', data.title),\r\n                  ]),\r\n                  data.comments.map((c, idx) =>\r\n                    m(Comment, {\r\n                      key: idx,\r\n                      comment: c,\r\n                      model,\r\n                    })\r\n                  ),\r\n                ]\r\n                : '',\r\n          model.state.showUser && model.state.user.id\r\n            ? m(Modal, { ...userModalInfo(model), model })\r\n            : '',\r\n        ]\r\n      )\r\n    },\r\n  }\r\n}\r\n\r\nconst toRoute = (model) => ({\r\n  onmatch: (_, path) => init(model)(path),\r\n  render: () =>\r\n    m(\r\n      Layout,\r\n      {\r\n        model,\r\n      },\r\n      m(Component, {\r\n        model,\r\n      })\r\n    ),\r\n})\r\n\r\nconst makeRoutes = (model) => (toRoute) => (routes, route) => {\r\n  routes[`/${route}`] = toRoute(model)\r\n  return routes\r\n}\r\n\r\nexport const App = (model) =>\r\n  model.routes.reduce(makeRoutes(model)(toRoute), {})\r\n","export const isEmpty = (data) => data.length == 0\r\n\r\nexport const infiniteScroll = (model) => (e) => {\r\n  let route = model.state.route\r\n  let length = model.data[route].data.length\r\n  let setpoint = 10 * length * model.state.scrollPos\r\n  if (e.target.scrollTop - model.state.scrollPos >= setpoint) {\r\n    model.state.scrollPos++ + e.target.scrollTop\r\n    if (length < model.data[route].limit) {\r\n      model.getData(model)(route)\r\n    }\r\n  }\r\n}\r\n\r\nexport const init = (model) => (path) => {\r\n  model.state.page = 1\r\n  let id = path.split('/')[2]\r\n  let route = path.split('/')[1]\r\n  return id ? model.getDataById(model)(route)(id) : model.getData(model)(path)\r\n}\r\n","import m from 'mithril'\r\nconst root = document.body\r\nimport { model } from './Model.js'\r\n\r\nimport { App } from './App.js'\r\n\r\n\r\nif (module.hot) {\r\n  module.hot.accept()\r\n}\r\n\r\nif (process.env.NODE_ENV !== 'production') {\r\n  console.log('Looks like we are in development mode!')\r\n}\r\n\r\n// Styles\r\nimport './index.css'\r\nimport './utils/animations.css'\r\nimport './utils/loader.css'\r\n\r\nfunction getProfile(w) {\r\n  if (w < 668) return 'phone'\r\n  if (w < 920) return 'tablet'\r\n  return 'desktop'\r\n}\r\n\r\nlet winW = window.innerWidth\r\nmodel.state.profile = getProfile(winW)\r\n\r\nfunction checkWidth() {\r\n  const w = window.innerWidth\r\n  if (winW !== w) {\r\n    winW = w\r\n    var lastProfile = model.state.profile\r\n    model.state.profile = getProfile(w)\r\n    if (lastProfile != model.state.profile) m.redraw()\r\n  }\r\n  requestAnimationFrame(checkWidth)\r\n}\r\n\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', () => {\r\n    navigator.serviceWorker.register('./service-worker.js').then(registration => {\r\n      console.log('🧟 SW registered: ', registration)\r\n    }).catch(registrationError => {\r\n      console.log('⚙️ SW registration failed: ', registrationError)\r\n    })\r\n  })\r\n}\r\n\r\n\r\ncheckWidth()\r\n\r\nm.route(root, '/news', App(model))\r\n"],"sourceRoot":""}